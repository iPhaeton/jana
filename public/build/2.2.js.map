{"version":3,"sources":["webpack:///./javascripts/modals.js"],"names":["Details","parent","data","ModalWindow","call","elem","attr","css","background","padding","prototype","Object","create","constructor","render","self","html","content","$","createContent","shop","mode","saveButton","float","addButton","cancelButton","append","on","submit","bind","editButtonClick","_render","find","remove","panel","table","items","specs","i","length","addField","key","val","prepend","event","target","removeField","close","blur","container","value","children","num","eq","form","_id","serializeArray","err","alert","message","getData","dataUrl","preventDefault","Dialog","db","createData","callback","fakeParent","formData","url","storedData","sideMenuActive","AuthWindow","type","border","borderRadius","minWidth","button","margin","location","reload","zIndex","focusExecuted","preventScrolling","closeButton","width","height","closeImg","hover","cursor","clearFix","insertAfter","position","visibility","document","body","window","off","setTimeout","win","top","scrollTop","left","scrollLeft","prevent","doc","overflow"],"mappings":"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","file":"2.2.js","sourcesContent":["\"use strict\";\r\n\r\nimport {makeDBSaveRequest, makeAuthorizationRequest} from \"./ajaxClient\";\r\nimport {findTarget, gatherItemsInOrder} from \"./axillaries\";\r\n\r\n//Details---------------------------------------------------------------------------------------------------------------\r\nfunction Details (parent) {\r\n    if (!parent.data) return;\r\n    \r\n    ModalWindow.call(this, false);\r\n\r\n    this.parent = parent;\r\n\r\n    this.elem.attr(\"id\", \"details\");\r\n    this.elem.css({\r\n        background: \"#079\",\r\n        padding: \"0px\"\r\n    });\r\n};\r\n\r\nDetails.prototype = Object.create(ModalWindow.prototype);\r\nDetails.prototype.constructor = Details;\r\n\r\nDetails.prototype.render = function () {\r\n    var self = this;\r\n\r\n    if (!this.elem.html()) {\r\n        this.content = $(\"<form></form>\");\r\n        \r\n        this.createContent();\r\n        \r\n        if (shop.mode === \"edit\") {\r\n            var saveButton = $(\"<button type='submit' class='btn btn-default' id='save-button'>Сохранить</button>\");\r\n            saveButton.css({\r\n                float: \"right\"\r\n            });\r\n\r\n            var addButton = $(\"<button type='button' class='btn btn-default' id='add-button'>Добавить</button>\");\r\n\r\n            var cancelButton = $(\"<button type='button' class='btn btn-default' id='cancel-button'>Отмена</button>\");\r\n            cancelButton.css({\r\n                float: \"right\"\r\n            });\r\n\r\n            this.content.append(cancelButton);\r\n            this.content.append(addButton);\r\n            this.content.append(saveButton);\r\n        };\r\n    };\r\n    \r\n    this.content.on(\"submit\", this.submit.bind(this));\r\n    this.content.on(\"click\", \".btn\", this.editButtonClick.bind(this));\r\n\r\n    this._render(this.content);\r\n};\r\n\r\nDetails.prototype.createContent = function () {\r\n    this.elem.find(\"#details__content\").remove();\r\n    \r\n    var panel = $(\"<div class='panel panel-default' id='details__content'></div>\");\r\n    this.table = $(\"<table class='table'><tbody></tbody></table>\");\r\n\r\n    //for some reason properties are read in the opposite order\r\n    var items = gatherItemsInOrder(this.parent.data.specs);\r\n\r\n    for (var i = items.length - 1; i >= 0; i--) {\r\n        this.addField(this.table.find(\"tbody\"), {key: items[i], val: this.parent.data.specs[items[i]]});\r\n    };\r\n\r\n    panel.append(this.table);\r\n    this.content.prepend(panel);\r\n};\r\n\r\nDetails.prototype.editButtonClick = function (event) {\r\n    var target = $(event.target);\r\n    target = findTarget(target, \"btn\");\r\n    if (!target) return;\r\n\r\n    switch (target.attr(\"id\")) {\r\n        case \"add-button\":\r\n            this.addField(this.table.find(\"tbody\"));\r\n            break;\r\n        case \"rm-button\":\r\n            this.removeField(this.table.find(\"tbody\"), target.attr(\"num\"));\r\n            break;\r\n        case \"cancel-button\":\r\n            this.createContent();\r\n            this.close();\r\n            break;\r\n    };\r\n    \r\n    target.blur();\r\n};\r\n\r\nDetails.prototype.addField = function (container, value) {\r\n    if (shop.mode === \"edit\") {\r\n        container.append(\r\n            \"<tr>\\\r\n                <td><input name='key' value='\" + (value ? value.key : \"\") + \"'></td>\\\r\n                <td><input name='val' value='\" + (value ? value.val : \"\") +\"'></td>\\\r\n                <td><input type='button' class='btn' id='rm-button' num='\" + container.children().length + \"' value='Удалить'></td>\\\r\n            </tr>\");\r\n    } else {\r\n        container.append(\r\n            \"<tr>\\\r\n                <td>\" + (value ? value.key : \"\") + \"</td>\\\r\n                <td>\" + (value ? value.val : \"\") + \"</td>\\\r\n            </tr>\");\r\n    };\r\n};\r\n\r\nDetails.prototype.removeField = function (container, num) {\r\n    container.children().eq(+num).remove();\r\n    \r\n    for (var i = +num; i < container.children().length; i++) {\r\n        container.children().eq(i).find(\"input\").attr(\"num\", i);\r\n    };\r\n};\r\n\r\nDetails.prototype.submit = function (event) {\r\n    var form = $(event.target);\r\n\r\n    var self = this;\r\n    makeDBSaveRequest(\"/dbsave?db=Commodity&id=\" + this.parent.data._id, form.serializeArray(), function (err) {\r\n        if (err) alert (err.message);\r\n        shop.getData(self.parent.dataUrl, shop.createContent);\r\n    });\r\n\r\n    this.close();\r\n\r\n    event.preventDefault();\r\n};\r\n\r\n//Dialog-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n//createData - function to create data, if data to be submitted doesn't comply with data in form\r\n//callback - to be called after a data is saved to a database\r\nfunction Dialog (items, db, createData, callback) {\r\n    var fakeParent = {\r\n        data: {\r\n            _id: null,\r\n            specs: items\r\n        }\r\n    };\r\n\r\n    Details.call(this, fakeParent);\r\n\r\n    this.db = db;\r\n    this.createData = createData;\r\n    this.callback = callback;\r\n};\r\n\r\nDialog.prototype = Object.create(Details.prototype);\r\nDialog.prototype.constructor = Dialog;\r\n\r\nDialog.prototype.submit = function (event) {\r\n    var self = this;\r\n    var form = $(event.target);\r\n\r\n    if (this.createData) var formData = this.createData(form);\r\n    else {\r\n        var formData = form.serializeArray();\r\n        formData.url = \"/dbsearch?db=Commodity&specs=specs.Категория:\" + formData[3].value;\r\n    }\r\n\r\n    if (!formData.url && shop.storedData) formData.url = shop.storedData.url;\r\n    makeDBSaveRequest(\"/dbsave?db=\" + this.db + \"&id=\" + this.parent.data._id, formData, function (err) {\r\n        if (err) {\r\n            if (self.callback) self.callback(err);\r\n            else alert (err.message);\r\n            return;\r\n        }\r\n\r\n        if (formData) {\r\n            shop.getData(formData.url, function () {\r\n                shop.createContent();\r\n                if (self.callback) self.callback(null, formData);\r\n\r\n                if (self.db === \"Category\") {\r\n                    shop.sideMenuActive($(\".side-menu a[href='\" + formData.url + \"']\"));\r\n                };\r\n            });\r\n        };\r\n    });\r\n\r\n    this.close();\r\n\r\n    event.preventDefault();\r\n};\r\n\r\n//Authentification Window----------------------------------------------------------------------------------------------------------------------------------------------------\r\nfunction AuthWindow (type) {\r\n    ModalWindow.call(this, true);\r\n    \r\n    this.elem.attr(\"id\", \"authentification\");\r\n    this.elem.css({\r\n        background: \"#fff\",\r\n        padding: \"5px\",\r\n        border: \"1px solid #ccc\",\r\n        borderRadius: \"5px\"\r\n    });\r\n\r\n    this.type = type;\r\n};\r\n\r\nAuthWindow.prototype = Object.create(ModalWindow.prototype);\r\nAuthWindow.prototype.constructor = AuthWindow;\r\n\r\nAuthWindow.prototype.render = function () { \r\n    this.form = $(\r\n    \"<form>\\\r\n        <div class='form-group'>\\\r\n            <label for='username' class='sr-only'>Имя пользователя</label>\\\r\n                <input type='text' class='form-control' name='username' id='username' placeholder='Имя пользователя'>\\\r\n        </div>\\\r\n        <div class='form-group'>\\\r\n            <label for='password' class='sr-only'>Пароль</label>\\\r\n                <input type='password' class='form-control' name='password' id='password' placeholder='Пароль' autocomplete='off'>\\\r\n        </div>\\\r\n    </form>\");\r\n    \r\n    this.form.css({\r\n        minWidth: 300\r\n    });\r\n\r\n    var button = $(\"<button type='submit' class='btn btn-primary' id='auth-button'>\" + ((this.type === \"signin\") ? \"Войти\" : (this.type === \"signup\") ? \"Регистрация\" : \"\") + \"</button>\");\r\n    button.css({\r\n        margin: \"0 10px 10px 10px\",\r\n        float: \"right\"\r\n    });\r\n    this.form.append(button);\r\n\r\n    this.form.on(\"submit\", this.submit.bind(this));\r\n    \r\n    this._render(this.form);\r\n};\r\n\r\nAuthWindow.prototype.submit = function (event) {\r\n    makeAuthorizationRequest(\"/\" + this.type, this.form, function (err) {\r\n        if (err) alert (err.message);\r\n        else {\r\n            ModalWindow.prototype.close();\r\n            location.reload();\r\n        };\r\n    });\r\n\r\n    event.preventDefault();\r\n};\r\n\r\n//Modal window---------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n//romove shows if the window should be removed whe deleted or jast detach\r\nfunction ModalWindow () {\r\n    this.elem = $(\"<div class='mod'></div>\");\r\n    this.elem.css({\r\n        zIndex: 3\r\n    });\r\n    \r\n    this.focusExecuted = false;\r\n};\r\n\r\nModalWindow.prototype._render = function (content) {\r\n    this.close();\r\n    \r\n    this.preventScrolling(true);\r\n\r\n    if (!this.elem.html()) {\r\n        if (content) this.elem.append(content);\r\n\r\n        this.closeButton = $(\"<div></div>\");\r\n        this.closeButton.css({\r\n            width: \"20px\",\r\n            height: \"20px\",\r\n            float: \"right\"\r\n        });\r\n        var closeImg = $(\"<img src='/images/gtk-close.png'>\");\r\n        closeImg.css({\r\n            width: \"100%\",\r\n            height: \"100%\"\r\n        });\r\n        this.closeButton.append(closeImg);\r\n        this.closeButton.hover(function () {\r\n            $(this).css({\r\n                cursor: \"pointer\"\r\n            })\r\n        });\r\n\r\n        var clearFix = ($(\"<div class='clearfix'></div>\"));\r\n\r\n        this.elem.prepend(this.closeButton);\r\n        clearFix.insertAfter(this.closeButton);\r\n\r\n        this.elem.css({\r\n            position: \"fixed\"\r\n        });\r\n    };\r\n\r\n    this.elem.css({\r\n        visibility: \"hidden\" //To prevent scampering of a modal across the window, visibility is restored after positioning\r\n    });\r\n    $(document.body).append(this.elem);\r\n\r\n    this.closeButton.on(\"click\", this.close.bind(this));\r\n\r\n    $(window).on(\"resize\", this.position.bind(this));\r\n    \r\n    //Crazy firefox' feature that js isn't executed again, when a page is returned to, but window.onresize is lost, when a page is left\r\n    //So I listen to document.onfocus and add window.onresize again\r\n    $(document).on(\"focus\", function () {\r\n        if (this.focusExecuted) return;\r\n\r\n        this.focusExecuted = true;\r\n        \r\n        $(window).off(\"resize\", this.position.bind(this)); //just in case\r\n        $(window).on(\"resize\", this.position.bind(this)); //when comming back from anothr page\r\n    }.bind(this));\r\n\r\n    //if we go away from the page by some link, when we come back we will need to add window.onresize again\r\n    $(document).on(\"click\", function (event) {\r\n        if ($(event.target).attr(\"href\")) this.focusExecuted = false;\r\n        $(window).off(\"resize\", this.position.bind(this)); //just in case\r\n        $(window).on(\"resize\", this.position.bind(this)); //when an element with href is pressed, but page hasn't been reloaded\r\n    }.bind(this));\r\n\r\n    this.position();\r\n};\r\n\r\n//set position when the window is resized\r\nModalWindow.prototype.position = function () {\r\n    var self = this;\r\n\r\n    setTimeout(function () { //To prevent multiple executions\r\n        var win = $(window);\r\n\r\n        if (self.elem.width() > win.width()) {\r\n            self.elem.css({\r\n                position: \"absolute\",\r\n                top: win.scrollTop() + 30 + \"px\",\r\n                left: \"0px\"\r\n            });\r\n        } else if (self.elem.height()+30 > win.height()) {\r\n            self.elem.css({\r\n                position: \"absolute\",\r\n                top: win.scrollTop() + \"px\",\r\n                left: win.scrollLeft() + win.width()/2 - self.elem.width()/2 + \"px\",\r\n            });\r\n        } else {\r\n            self.elem.css({\r\n                position: \"fixed\",\r\n                top: \"30px\",\r\n                left: win.scrollLeft() + win.width()/2 - self.elem.width()/2 + \"px\",\r\n            });\r\n        };\r\n\r\n        self.elem.css({\r\n            visibility: \"visible\"\r\n        });\r\n    }, 0);\r\n};\r\n\r\nModalWindow.prototype.close = function () {\r\n    $(\".mod\").remove();\r\n    \r\n    this.preventScrolling(false);\r\n};\r\n\r\nModalWindow.prototype.preventScrolling = function (prevent) {\r\n    var doc = $(document);\r\n    \r\n    $(document.body).css({\r\n        overflow: prevent ? \"hidden\" : \"visible\"\r\n    });\r\n    \r\n    if (prevent) {\r\n        var background = $(\"<div class='dim-background'></div>\");\r\n        background.css({\r\n            position: \"absolute\",\r\n            top: 0,\r\n            left: 0,\r\n            width: \"100%\",\r\n            height: doc.height(),\r\n            background: \"rgba(0,0,0,.5)\",\r\n            zIndex: 2\r\n        });\r\n        $(document.body).append(background);\r\n    } else {\r\n        $(\".dim-background\").remove();\r\n    }\r\n};\r\n\r\nexport {Details, Dialog, AuthWindow, ModalWindow};\n\n\n/** WEBPACK FOOTER **\n ** ./javascripts/modals.js\n **/"],"sourceRoot":""}