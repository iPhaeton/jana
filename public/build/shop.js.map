{"version":3,"sources":["webpack:///./javascripts/shopClient.js","webpack:///./javascripts/searchPanel.js","webpack:///./javascripts/SockConnection.js","webpack:///./javascripts/sideMenu.js"],"names":["searchPanel","$","document","ready","shop","mode","socket","window","location","origin","connect","editPanel","EditPanel","body","css","height","popups","on","event","target","preventDefault","getData","attr","createContent","url","callback","submit","config","data","require","async","parallel","err","results","storedConfig","parseConfig","storedData","alert","thumbnails","clear","Thumbnails","build","render","field","showcase","Function","elem","tiles","Set","previousWindowWidth","focusExecuted","setHandlers","prototype","doc","add","Thumbnail","row","tile","append","clearTiles","dataToAdd","done","newThumbnail","push","html","unrender","executeAnyway","windowWidth","width","arrangeClears","bind","clearThis","removeClass","i","addClass","off","parent","dataUrl","img","undefined","specs","Details","details","self","withTitle","color","split","col","div","textAlign","hover","cursor","chooseImage","button","fields","length","p","showPopupMenu","trigger","_id","chooseImageOnServer","text","message","showDirList","list","messge","files","showDirPopupMenu","menu","PopupMenu","remove","selectedImage","showImage","deleteImage","hasClass","popupMenu","delete","parentList","iframe","appendTo","position","top","left","background","zIndex","contents","find","EditSwitch","float","margin","switchMode","createUploadInput","toggle","uploadInput","border","padding","callerId","id","switch","buttonClick","addCommodity","addCategory","removeAttr","Dialog","questionnaire","dialog","form","formData","serializeArray","name","value","invokingEvent","items","unremovable","item","addField","itemName","onclick","oncontextmenu","close","offset","clientX","scrollLeft","pageXOffset","documentElement","clientWidth","get","offsetWidth","clientY","scrollTop","detach","sideMenuActive","SearchPanel","options","toggleButton","input","setEvents","SearchPanelPopupControl","keyCode","ctrlKey","shiftKey","hidePopups","unsetEvents","hide","toggleClass","setTimeout","request","serialize","val","searchData","popup","sockJSClient","makeSearchRequest","showSearchResult","send","JSON","stringify","create","Object","defineProperty","_data","getValues","values","createCol","bodyWidth","Math","ceil","handleBodySize","clearTimeout","handleBodySizeTimer","win","outerHeight","right","SockConnection","callbacks","searchResult","SockJS","connection","onopen","onmessage","json","parse","type","key","Error","lastRequest","sideMenuListener","menuButtonClick","findTarget","deleteCategory","makeDBDelRequest","blur"],"mappings":"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","file":"shop.js","sourcesContent":["\"use strict\";\r\n\r\nimport headMenuListener from \"./headMenu\";\r\nimport {makeDBSearchRequest,\r\n        makeFileSaveRequest,\r\n        makeListRequest,\r\n        makeFileDeleteRequest,\r\n        makeDBDelRequest} from \"./ajaxClient\";\r\nimport SearchPanel from \"./searchPanel\";\r\nimport {findTarget,gatherItemsInOrder} from \"./axillaries\";\r\nimport SockConnection from \"./SockConnection\"\r\nimport {sideMenuListener, sideMenuActive} from \"./sideMenu\"\r\n\r\nvar searchPanel;\r\n\r\n//shop.storedData - data and configare not necesarily needed to be reloaded on every getData\r\n//shop.storedConfig - data and configare not necesarily needed to be reloaded on every getData\r\n$(document).ready(function () {\r\n    shop.mode = \"view\";\r\n\r\n    shop.socket = new SockConnection(window.location.origin + \"/sock\");\r\n    shop.socket.connect();\r\n\r\n    headMenuListener();\r\n    sideMenuListener();\r\n\r\n    var editPanel = new EditPanel();\r\n\r\n    $(document.body).css({\r\n        height: $(window).height()\r\n    });\r\n\r\n    searchPanel = new SearchPanel({\r\n        popups:[\r\n            \"Производитель\"\r\n        ]\r\n    });\r\n\r\n    $(\".side-menu\").on(\"click\", \".menu-button\", function (event) {\r\n        var target = $(event.target);\r\n        target = findTarget(target, \"menu-button\", \"a\");\r\n        if(!target) {\r\n            event.preventDefault();\r\n            return;\r\n        };\r\n\r\n        sideMenuActive(target);\r\n\r\n        getData(target.attr(\"href\"), createContent);\r\n\r\n        event.preventDefault();\r\n    });\r\n});\r\n\r\nfunction getData(url, callback) {\r\n    if (url === \"search\") {\r\n        searchPanel.submit();\r\n        return;\r\n    }\r\n\r\n    var config,\r\n        data;\r\n\r\n    require.ensure([\"async\"], () => {\r\n        var async = require(\"async\");\r\n\r\n        async.parallel([\r\n            //get configuration\r\n            function (callback) {\r\n                makeDBSearchRequest(\"/dbsearch?db=Config\", callback);\r\n            },\r\n            function (callback) {\r\n                makeDBSearchRequest(url, callback);\r\n            }\r\n        ], function (err, results) {\r\n            shop.storedConfig = config = parseConfig(results[0][0]);\r\n            shop.storedData = data = results[1];\r\n            data.url = url;\r\n\r\n            if (err) {\r\n                alert(\"Извините, проблема с базой данных\");\r\n                return;\r\n            };\r\n\r\n            callback(data, config);\r\n        });\r\n    }, \"async\");\r\n};\r\n\r\nfunction createContent (data, config) {\r\n    //if called without any of the arguments, that argument is taken from the global variable\r\n    //data and config are stored in global variables when they are taken from the database\r\n    var data = data || shop.storedData,\r\n        config = config || shop.storedConfig;\r\n\r\n    if (!data && shop.thumbnails) {\r\n        shop.thumbnails.clear();\r\n    } \r\n    if(!config) return;\r\n\r\n    if (!shop.thumbnails) shop.thumbnails = new Thumbnails(\"#commodity-list\", data, config);\r\n    shop.thumbnails.clear();\r\n    shop.thumbnails.build(data, config);\r\n    shop.thumbnails.render();\r\n};\r\n\r\n//parse the config object------------------------------------------------------------------------------------------\r\nfunction parseConfig(config) {\r\n    for (var field in config.showcase) {\r\n        if (config.showcase[field].css) {\r\n            config.showcase[field].css = new Function (\"data\", config.showcase[field].css);\r\n        };\r\n    };\r\n\r\n    return config;\r\n};\r\n\r\n//Thumbnails-------------------------------------------------------------------------------------------------------\r\nfunction Thumbnails (elem, config) {\r\n    this.elem = $(elem);\r\n    this.tiles = new Set();\r\n    this.previousWindowWidth = 0;\r\n    this.focusExecuted = false;\r\n\r\n    this.data = [];\r\n\r\n    this.setHandlers();\r\n};\r\n\r\nThumbnails.prototype.build = function (data, config) {\r\n    if (!data) return;\r\n\r\n    this.data = data;\r\n    this.config = config;\r\n\r\n    for (var doc of this.data) {\r\n        this.tiles.add((new Thumbnail(this, doc, this.config, this.data.url)).elem);\r\n    };\r\n};\r\n\r\nThumbnails.prototype.render = function () {\r\n    this.row = $(\"<div class='row'></div>\");\r\n\r\n    for (var tile of this.tiles) {\r\n        this.row.append(tile);\r\n    };\r\n\r\n    this.elem.append(this.row);\r\n\r\n    this.clearTiles(true)();\r\n};\r\n\r\nThumbnails.prototype.add = function (dataToAdd, done) {\r\n    if (!this.row) {\r\n        this.row = $(\"<div class='row'></div>\");\r\n        this.elem.append(this.row);\r\n    };\r\n\r\n    var newThumbnail = (new Thumbnail(this, dataToAdd, this.config || shop.storedConfig, \"search\"));\r\n\r\n    this.tiles.add(newThumbnail.elem);\r\n    this.row.append(newThumbnail.elem);\r\n    this.clearTiles(true);\r\n\r\n    this.data.push(dataToAdd);\r\n    shop.storedData = this.data;\r\n\r\n    if (done) {\r\n        this.clearTiles(true)();\r\n    };\r\n};\r\n\r\nThumbnails.prototype.clear = function () {\r\n    this.data = [];\r\n    this.tiles.clear();\r\n    if (this.row) this.row.html(\"\");\r\n};\r\n\r\nThumbnails.prototype.unrender = function () {\r\n    this.elem.html(\"\");\r\n};\r\n\r\n//Need theese two functions to deal with tiles of differrent height\r\n//The first one defines, if the clearance should be done on a particular resize\r\nThumbnails.prototype.clearTiles = function (executeAnyway) {\r\n\r\n    return function () {\r\n        var windowWidth = $(window).width();\r\n\r\n        if (windowWidth < 768) {\r\n            if (this.previousWindowWidth >= 768 || executeAnyway) {\r\n                this.arrangeClears();\r\n            }\r\n        } else if (windowWidth >= 768 && windowWidth < 992) {\r\n            if (this.previousWindowWidth < 768 || this.previousWindowWidth >= 992 || executeAnyway) {\r\n                this.arrangeClears(3);\r\n            };\r\n        } else if (windowWidth >= 992 && windowWidth < 1200) {\r\n            if (this.previousWindowWidth < 992 || this.previousWindowWidth >= 1200 || executeAnyway) {\r\n                this.arrangeClears(4);\r\n            };\r\n        } else {\r\n            if (this.previousWindowWidth < 1200 || executeAnyway) {\r\n                this.arrangeClears(5);\r\n            };\r\n        }\r\n\r\n        this.previousWindowWidth = windowWidth;\r\n    }.bind(this);\r\n\r\n};\r\n\r\n//The second one does the clearance\r\nThumbnails.prototype.arrangeClears = function (clearThis) {\r\n    if (!clearThis) {\r\n        for (var tile in this.tiles) {\r\n            tile.removeClass(\"first-in-a-row\");\r\n        };\r\n        return;\r\n    };\r\n\r\n    clearThis--;\r\n\r\n    var i = 0;\r\n    for (var tile of this.tiles) {\r\n        if (i%clearThis === 0) {\r\n            tile.addClass(\"first-in-a-row\");\r\n        } else {\r\n            tile.removeClass(\"first-in-a-row\");\r\n        };\r\n        i++;\r\n    };\r\n};\r\n\r\nThumbnails.prototype.setHandlers = function () {\r\n    $(window).on(\"resize\", this.clearTiles(false));\r\n\r\n    //Crazy firefox' feature that js isn't executed again, when a page is returned to, but window.onresize is lost, when a page is left\r\n    //So I listen to document.onfocus and add window.onresize again\r\n    $(document).on(\"focus\", function () {\r\n        if (this.focusExecuted) return;\r\n\r\n        this.focusExecuted = true;\r\n\r\n        this.clearTiles(true)();\r\n        $(window).off(\"resize\", this.clearTiles(false)); //just in case\r\n        $(window).on(\"resize\", this.clearTiles(false)); //when coming back from another page\r\n    }.bind(this));\r\n\r\n    //if we go away from the page by some link, when we come back we will need to add window.onresize again\r\n    $(document).on(\"click\", function (event) {\r\n        if ($(event.target).attr(\"href\")) this.focusExecuted = false;\r\n        $(window).off(\"resize\", this.clearTiles(false)); //just in case\r\n        $(window).on(\"resize\", this.clearTiles(false)); //when an element with href is pressed, but page hasn't been reloaded\r\n    }.bind(this));\r\n};\r\n\r\n//Thumbnail--------------------------------------------------------------------------------------------------------\r\nfunction Thumbnail (parent, data, config, dataUrl) {\r\n    this.parent = parent;\r\n    this.data = data || {\r\n        img: undefined,\r\n        specs:{}\r\n    };\r\n    this.dataUrl = dataUrl;\r\n\r\n    require.ensure (\"./modals\", (require) => {\r\n        var Details = require(\"./modals\").Details;\r\n\r\n        this.details = new Details(this);\r\n        var self = this;\r\n\r\n        //config = undefined;\r\n        if (!config) {\r\n            config = {\r\n                showcase: {\r\n                    \"Название\": {\r\n                        withTitle: false\r\n                    },\r\n                    \"Цена\": {\r\n                        withTitle: false,\r\n                        css: {\r\n                            color: \"#c00\"\r\n                        }\r\n                    },\r\n                    \"В наличии\": {\r\n                        withTitle: true,\r\n                        css: (+(data.specs[\"В наличии\"].split(\" \")[0]) ? {\r\n                            color: \"#0f0\"\r\n                        } : {\r\n                            color: \"#f00\"\r\n                        })\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        var col = $(\"<div class='col-sm-6 col-md-4 col-lg-3'></div>\");\r\n\r\n        var div = $(\"<div class='thumbnail'></div>\");\r\n        div.css({\r\n            textAlign: \"right\",\r\n        });\r\n\r\n        var img = $(\"<img src=\" + (this.data.img || \"'images/defaultPic.gif'\") + \" class='thumbnail-img'>\");\r\n        //make the image clickable\r\n        if (shop.mode === \"edit\") {\r\n            img.hover(function () {\r\n                $(this).css({\r\n                    cursor: \"pointer\"\r\n                })\r\n            });\r\n            img.on(\"click\", this.chooseImage.bind(this));\r\n        };\r\n\r\n        var button = $(\"<button type='button' class='btn btn-default details-button' data-toggle='modal' data-target='details'>\" + (shop.mode === \"view\"? \"Подробнее>>\" : \"Редактировать>>\") + \"</button>\");\r\n        button.on(\"click\", function (event) {\r\n            self.details.render();\r\n        });\r\n\r\n        div.append(img);\r\n\r\n        var fields = gatherItemsInOrder(config.showcase);\r\n        for (var i = fields.length-1; i >= 0; i--) {\r\n            if (this.data.specs[fields[i]]) {\r\n                var p = $(\"<p>\" + ((config.showcase[fields[i]].withTitle) ? (fields[i] + \": \" + this.data.specs[fields[i]]) : (this.data.specs[fields[i]])) + \"</p>\");\r\n                if (config.showcase[fields[i]].css) p.css(config.showcase[fields[i]].css(this.data));\r\n                div.append(p);\r\n            };\r\n        };\r\n\r\n        div.append(button);\r\n\r\n        if (shop.mode === \"edit\") col.on(\"contextmenu\", this.showPopupMenu.bind(this));\r\n\r\n        col.append(div);\r\n\r\n        //return col;\r\n        this.elem = col;\r\n    });\r\n};\r\n\r\nThumbnail.prototype.chooseImage = function (event) {\r\n    $(\"#uploadInput\").trigger(\"click\", [this.data._id]);\r\n};\r\n\r\nThumbnail.prototype.chooseImageOnServer = function (event) {\r\n    var target = $(event.target);\r\n    target = findTarget(target, \"popup-button\");\r\n    if(!target) return;\r\n\r\n    var self = this;\r\n    makeFileSaveRequest(\"/savefile?id=\" + this.data._id, target.text(), function (err) {\r\n        if (err) alert (err.message);\r\n        getData(self.dataUrl, createContent);\r\n    });\r\n};\r\n\r\nThumbnail.prototype.showDirList = function (event) {\r\n    makeListRequest(\"/list?dir=images\" , (err, list) => {\r\n        if (err) alert(err.messge);\r\n        \r\n        var files = {};\r\n        for (var i = 0; i < list.length; i++) {\r\n            files[list[i]] = [this.chooseImageOnServer.bind(this), this.showDirPopupMenu.bind(this)];\r\n        };\r\n        \r\n        var menu = new PopupMenu(this.elem, event, files, true);\r\n        menu.elem.addClass(\"dir-list\");\r\n    });\r\n};\r\n\r\nThumbnail.prototype.showDirPopupMenu = function (event) {\r\n    $(\".popup-menu[unremovable='false']\").remove();\r\n\r\n    var target = findTarget($(event.target), \"popup-button\");\r\n    if (!target) return;\r\n    \r\n    this.selectedImage = target.text();\r\n    \r\n    var menu = new PopupMenu(this.elem, event, {\r\n        \"Посмотреть\": [this.showImage.bind(this)],\r\n        \"Удалить\": [this.deleteImage.bind(this)]\r\n    });\r\n};\r\n\r\nThumbnail.prototype.showPopupMenu = function (event) {\r\n    var target = findTarget($(event.target), \"thumbnail thumbnail-img details-button popup-menu\");\r\n    if (!target) {\r\n        $(\".popup-menu\").remove();\r\n        return;\r\n    };\r\n\r\n    if (!target.hasClass(\"popup-menu\")) $(\".popup-menu\").remove();\r\n\r\n    if (target.hasClass(\"thumbnail\")) {\r\n        var popupMenu = new PopupMenu(this.elem, event, {\r\n            \"Удалить товар\": [this.delete.bind(this)]\r\n        });\r\n    } else if (target.hasClass(\"thumbnail-img\")) {\r\n        var popupMenu = new PopupMenu(this.elem, event, {\r\n            \"Загрузить новое изображение\": [this.chooseImage.bind(this)],\r\n            \"Выбрать изображение на сервере\": [this.showDirList.bind(this)]\r\n        });\r\n    } else if (target.hasClass(\"details-button\")) {\r\n        return;\r\n    };\r\n\r\n    event.preventDefault();\r\n};\r\n\r\nThumbnail.prototype.showImage = function (event) {\r\n    $(\"#image-preview\").remove();\r\n    var parentList = $(\".dir-list\");\r\n    \r\n    this.iframe = $(\"<iframe id='image-preview' src='images/\" + this.selectedImage + \"' scrolling='no'></iframe>\");\r\n    this.iframe.appendTo(parentList.parent()); \r\n    this.iframe.css({\r\n        position: \"absolute\",\r\n        top: parentList.position().top + \"px\",\r\n        left: parentList.position().left + parentList.width() + \"px\",\r\n        background: \"#fff\",\r\n        zIndex: \"1\"\r\n    });\r\n\r\n    this.iframe.on(\"load\", (function () {\r\n        var img = this.iframe.contents().find(\"img\");\r\n        if ((img.width() > img.height()) && img.width() > this.iframe.width()) {\r\n            $(img).css({\r\n                width: \"100%\"\r\n            });\r\n        } else if (img.height() > this.iframe.height()) {\r\n            $(img).css({\r\n                height: \"100%\"\r\n            });\r\n        };\r\n    }).bind(this));\r\n};\r\n\r\nThumbnail.prototype.deleteImage = function (event) {\r\n    makeFileDeleteRequest(\"/delfile?dir=images&file=\" + this.selectedImage, function (err) {\r\n        if (err) alert(err.message);\r\n        getData(data.url, createContent);\r\n    });\r\n};\r\n\r\nThumbnail.prototype.delete = function (event) {\r\n    var self = this;\r\n    makeDBDelRequest(\"/dbdel?db=Commodity&id=\" + this.data._id, function (err) {\r\n        if (err) alert (err.message);\r\n        getData(self.dataUrl, createContent);\r\n    });\r\n};\r\n\r\n//Edit switch----------------------------------------------------------------------------------------------------------\r\nfunction EditSwitch(parent) {\r\n    this.parent = parent;\r\n\r\n    this.elem = $(\"<button type='button' class='btn btn-default'>Редактировать</button>\");\r\n    //this.elem.appendTo(document.body);\r\n    this.elem.appendTo($(\".main-content\"));\r\n\r\n    this.elem.css({\r\n        float: \"right\",\r\n        margin: \"5px\"\r\n        /*position: \"absolute\",\r\n        top: \"95%\",\r\n        left: \"90%\"*/\r\n    });\r\n\r\n    $(this.elem).on(\"click\", this.switchMode.bind(this));\r\n};\r\n\r\nEditSwitch.prototype.switchMode = function () {\r\n    if (shop.mode !== \"edit\") {\r\n        shop.mode = \"edit\";\r\n        this.elem.text(\"Просмотр\");\r\n        //create an input for uploading an image for a thumbnail\r\n        if (!$(\"#uploadInput\").length) this.createUploadInput();\r\n    } else {\r\n        shop.mode = \"view\";\r\n        this.elem.text(\"Редактировать\");\r\n    };\r\n\r\n    createContent();\r\n\r\n    this.parent.toggle();\r\n};\r\n\r\nEditSwitch.prototype.createUploadInput = function () {\r\n    var uploadInput = $(\"<input type='file'>\");\r\n    uploadInput.attr(\"id\", \"uploadInput\");\r\n    uploadInput.css({\r\n        width: \"0\",\r\n        height: \"0\",\r\n        border: \"0\",\r\n        padding: \"0\"\r\n    });\r\n    $(document.body).append(uploadInput);\r\n\r\n    var callerId;\r\n\r\n    uploadInput.on(\"click\", (event, id) => {\r\n        callerId = id;\r\n    });\r\n\r\n    uploadInput.on(\"change\", function (event) {\r\n        makeFileSaveRequest(\"/savefile?id=\" + callerId, this.files[0], function (err) {\r\n            if (err) alert (err.message);\r\n            getData(shop.storedData.url, createContent);//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n        });\r\n    });\r\n};\r\n\r\n//Edit panel-----------------------------------------------------------------------------------------------------------\r\nfunction EditPanel () {\r\n    if ($(\".main-content\").attr(\"admin-mode\") === \"true\") this.switch = new EditSwitch(this);\r\n\r\n    this.elem = $(\".edit-panel\");\r\n    this.elem.on(\"click\", \".edit-button\", this.buttonClick.bind(this));\r\n};\r\n\r\nEditPanel.prototype.buttonClick = function (event) {\r\n    var target = findTarget($(event.target), \"edit-button\");\r\n    switch (target.attr(\"id\")) {\r\n        case \"add-commodity\":\r\n            this.addCommodity();\r\n            return;\r\n        case \"add-category\":\r\n            this.addCategory();\r\n            return;\r\n    };\r\n};\r\n\r\nEditPanel.prototype.toggle = function () {\r\n    if (this.elem.attr(\"hidden\")) this.elem.removeAttr(\"hidden\");\r\n    else this.elem.attr(\"hidden\", \"true\");\r\n};\r\n\r\nEditPanel.prototype.addCommodity = function () {\r\n    require.ensure (\"./modals\", (require) => {\r\n        var Dialog = require(\"./modals\").Dialog;\r\n\r\n        var questionnaire = new Dialog ({\r\n            \"Категория\": \"Лыжи\",\r\n            \"Название\": \"\"\r\n        }, \"Commodity\");\r\n\r\n        questionnaire.render();\r\n    });\r\n};\r\n\r\nEditPanel.prototype.addCategory = function () {\r\n    require.ensure (\"./modals\", (require) => {\r\n        var Dialog = require(\"./modals\").Dialog;\r\n\r\n        var dialog = new Dialog({\"Категория\": \"\"}, \"Category\", function (form) {\r\n            var formData = form.serializeArray();\r\n            return {\r\n                name: formData[1].value,\r\n                url: \"/dbsearch?db=Commodity&specs=specs.Категория:\" + formData[1].value,\r\n                position: $(\".menu-button\").length\r\n            };\r\n        }, function (err, data) {\r\n            if (err) {\r\n                if (err.message === \"Документ уже существует\") alert(\"Яна, категория с таким имененм у тебя уже есть\");\r\n                else alert(err.message);\r\n                return;\r\n            }\r\n\r\n            $(\".side-menu\").append(\"\\\r\n            <li class='menu-button'>\\\r\n                <a role='presentation' href='\" + data.url + \"'>\" + data.name + \"</a>\\\r\n            </li>\\\r\n        \");\r\n        });\r\n        dialog.render();\r\n    });\r\n};\r\n\r\n//Popup menu-----------------------------------------------------------------------------------------------------------\r\nfunction PopupMenu(parent, invokingEvent, items, unremovable) { //unremovable means this popup should not be deleted on popup on itself\r\n    this.parent = parent;\r\n    this.elem = $(\"<div class='popup-menu'\" + (unremovable ? \"unremovable='true'\" : \"unremovable='false'\") + \"></div>\");\r\n    this.list = $(\"<ul class='list-group'></ul>\");\r\n    \r\n    for (var item in items) {\r\n        this.addField(item, items[item] ? items[item][0] : null, items[item] ? items[item][1] : null);\r\n    };\r\n    \r\n    this.elem.append(this.list);\r\n    \r\n    this.render(invokingEvent);\r\n};\r\n\r\nPopupMenu.prototype.addField = function (itemName, onclick, oncontextmenu) {\r\n    var item = $(\"<li class='btn list-group-item popup-button'>\" + itemName + \"</li>\");\r\n\r\n    this.list.append(item);\r\n\r\n    item.on(\"click\", (function (event) {\r\n        if (onclick) onclick(event);\r\n        event.preventDefault();\r\n        this.close();\r\n    }).bind(this));\r\n\r\n    item.on(\"contextmenu\", (function (event) {\r\n        if (oncontextmenu) oncontextmenu(event);\r\n        event.preventDefault();\r\n    }).bind(this));\r\n};\r\n\r\nPopupMenu.prototype.render = function (invokingEvent) {\r\n    var offset = this.parent.offset()\r\n    this.parent.append(this.elem);\r\n    this.elem.css({\r\n        position: \"absolute\",\r\n        left: invokingEvent ? (invokingEvent.clientX - offset.left + $(window).scrollLeft() + \"px\") : \r\n            ((window.pageXOffset || document.documentElement.scrollLeft) + (document.documentElement.clientWidth/2) - (this.elem.get(0).offsetWidth/2) - offset.left + \"px\"),\r\n        top: invokingEvent ? (invokingEvent.clientY - offset.top + $(window).scrollTop() + \"px\") : \"10%\",\r\n        zIndex: \"1\"\r\n    });\r\n};\r\n\r\nPopupMenu.prototype.close = function () {\r\n    this.elem.detach();\r\n};\r\n\r\nexport {parseConfig, Thumbnails, getData, createContent, sideMenuActive};\n\n\n/** WEBPACK FOOTER **\n ** ./javascripts/shopClient.js\n **/","\"use strict\";\r\n\r\nimport {findTarget} from \"./axillaries\";\r\nimport {makeDBSearchRequest} from \"./ajaxClient\";\r\n\r\n//SearchPanel----------------------------------------------------------------------------------------------------------------------\r\nexport default function SearchPanel(options) {\r\n    this.elem = $(\".search-panel\");\r\n    this.toggleButton = $(\".search-button\");\r\n    this.form = this.elem.find(\"form\");\r\n    this.input = this.elem.find(\"#search-input\");\r\n\r\n    this.setEvents();\r\n\r\n    this.popups = {};\r\n    if (options.popups) {\r\n        for (var i = 0; i < options.popups.length; i++) {\r\n            this.popups[options.popups[i]] = new SearchPanelPopupControl(options.popups[i], this.elem);\r\n        };\r\n    };\r\n};\r\n\r\nSearchPanel.prototype.setEvents = function () {\r\n\r\n    this.toggleButton.on(\"click\", this.toggle.bind(this));\r\n\r\n    $(document.documentElement).on(\"keydown\", this, function (event) {\r\n        if (event.keyCode === 70 && event.ctrlKey && event.shiftKey) event.data.toggle();\r\n    });\r\n\r\n    this.elem.on(\"click\", this.hidePopups.bind(this));\r\n\r\n    $(\".search-panel__hide-button\").on(\"click\", this.toggle.bind(this));\r\n\r\n    this.form.on(\"submit\", this.submit.bind(this));\r\n\r\n};\r\n\r\nSearchPanel.prototype.unsetEvents = function () {\r\n    $(document.documentElement).off(\"click keydown\", this.hide);\r\n};\r\n\r\nSearchPanel.prototype.toggle = function () {\r\n    var self = this;\r\n\r\n    this.elem.toggleClass(\"zero-width\");\r\n\r\n    if (!this.elem.hasClass(\"zero-width\")) {\r\n        setTimeout(function () {\r\n            $(document.documentElement).on(\"click keydown\", self, self.hide);\r\n        }, 0);\r\n    } else {\r\n        this.hidePopups();\r\n        this.unsetEvents();\r\n    };\r\n};\r\n\r\nSearchPanel.prototype.hide = function (event) {\r\n    var target = findTarget($(event.target), \"search-panel search-panel__popup-panel\");\r\n    if (target) return;\r\n\r\n    var self = event.data;\r\n\r\n    if (event.keyCode && event.keyCode !== 27) return;\r\n\r\n    self.toggle();\r\n    self.hidePopups(event);\r\n};\r\n\r\nSearchPanel.prototype.hidePopups = function (event) {\r\n    //if (event && $(event.target).closest(\".search-panel__control-popup\").length) return;\r\n    if (event && findTarget($(event.target), \"search-panel__control-popup search-panel__popup-panel\")) return;\r\n\r\n    for (let i in this.popups) {\r\n        this.popups[i].hide();\r\n    };\r\n};\r\n\r\nSearchPanel.prototype.submit = function (event) {\r\n    var self = this;\r\n\r\n    if (event) event.preventDefault();\r\n\r\n    var request = this.form.serialize();\r\n    \r\n    if (!this.input.val().length) return;\r\n\r\n    var searchData = {};\r\n    for (let popup in this.popups) {\r\n        searchData[popup] = this.popups[popup].getData();\r\n    };\r\n    \r\n    var config,\r\n        data;\r\n\r\n    require.ensure([\"async\"], () => {\r\n        var async = require(\"async\");\r\n\r\n        async.parallel([\r\n            function (callback) {\r\n                if (!shop.storedConfig) makeDBSearchRequest(\"/dbsearch?db=Config\", callback);\r\n                else callback();\r\n            },\r\n            function (callback) {\r\n                require(\"bundle!./sockJSClient\")(function (sockJSClient) {\r\n                    var makeSearchRequest = sockJSClient.makeSearchRequest;\r\n                    makeSearchRequest(request, searchData, callback, self.showSearchResult);\r\n                });\r\n            }\r\n        ], (function (err, results) {\r\n            if (event) this.toggle();\r\n\r\n            if (results[0]) {\r\n                shop.storedConfig = config = shop.parseConfig(results[0][0]);\r\n            }\r\n            ;\r\n\r\n            //createContent(null, config || storedConfig);\r\n            if (shop.thumbnails) {\r\n                shop.thumbnails.clear();\r\n                shop.thumbnails.data.url = \"search\";\r\n            }\r\n            ;\r\n\r\n            shop.socket.send(JSON.stringify({\r\n                request: \"/searchResults\"\r\n            }));\r\n        }).bind(this));\r\n    }, \"async\");\r\n};\r\n\r\nSearchPanel.prototype.showSearchResult = function (data, done) {\r\n    if (!shop.thumbnails) {\r\n        shop.thumbnails = new shop.Thumbnails(\"#commodity-list\", shop.storedData, shop.storedConfig);\r\n        shop.thumbnails.data.url = \"search\";\r\n    }\r\n    shop.thumbnails.add(data, done);\r\n};\r\n\r\n//SearchPanelPopupControl-------------------------------------------------------------------------------------------------------\r\nfunction SearchPanelPopupControl (name, parent) {\r\n    this.elem = $(\"<div class='search-panel__popup'></div>\");\r\n    this.name = name;\r\n    this.parent = parent;\r\n\r\n    this.create();\r\n    this.render();\r\n\r\n    Object.defineProperty(this, \"data\", {\r\n        get: function () {\r\n            this.body.submit();\r\n            return this._data;\r\n        }\r\n    });\r\n};\r\n\r\nSearchPanelPopupControl.prototype.create = function () {\r\n    var self = this;\r\n\r\n    this.button = $(\r\n        '<div class=\"search-panel__control-popup\">\\\r\n            <p class=\"search-panel__control-popup__text\">' + this.name + '</p>\\\r\n            <span class=\"glyphicon glyphicon-chevron-down search-panel__control-popup__icon\" aria-hidden=\"true\"></span>\\\r\n        </div>');\r\n\r\n    this.body = $(\r\n        \"<form class='search-panel__popup-panel zero-display'>\\\r\n            <div class='row'></div>\\\r\n        </form>\");\r\n\r\n    this.getValues(function (err, values) {\r\n        let col = createCol();\r\n\r\n        let i = 1;\r\n        for (var value in values) {\r\n            col.append(\"<label class='checkbox'><input type='checkbox' name='\" + value + \"'>\" + value + \"</label>\");\r\n            if (i++ % 20 === 0) col = createCol();\r\n        };\r\n        self.bodyWidth = Math.ceil(i/20)*250;\r\n        self.body.css({\r\n            width: self.bodyWidth + \"px\"\r\n        });\r\n        $(\".col\").addClass(\"col-xs-\" + (12/Math.ceil(i/20)));\r\n\r\n        $(window).on(\"resize\", self.handleBodySize.bind(self));\r\n\r\n        function createCol() {\r\n            let row = self.body.find(\".row\"),\r\n                col = $(\"<div class='col'></div>\");\r\n            row.append(col);\r\n            return col;\r\n        };\r\n    });\r\n\r\n    this.elem.append(this.button);\r\n    //this.elem.append(this.body);\r\n    $(document.body).append(this.body);\r\n\r\n    this.setEvents();\r\n};\r\n\r\nSearchPanelPopupControl.prototype.getValues = function (callback) {\r\n    makeDBSearchRequest(\"/dbsearch?db=Commodity&field=specs.\" + this.name, callback);\r\n};\r\n\r\nSearchPanelPopupControl.prototype.setEvents = function () {\r\n    this.button.on(\"click\", this.toggle.bind(this));\r\n    this.body.on(\"click\", this.hide.bind(this));\r\n};\r\n\r\nSearchPanelPopupControl.prototype.render = function () {\r\n    this.parent.append(this.elem);\r\n};\r\n\r\nSearchPanelPopupControl.prototype.toggle = function () {\r\n    this.body.toggleClass(\"zero-display\");\r\n    this.handleBodySize();\r\n};\r\n\r\nSearchPanelPopupControl.prototype.hide = function (event) {\r\n    if (event && findTarget($(event.target), \"col\")) return;\r\n\r\n    this.body.addClass(\"zero-display\");\r\n};\r\n\r\nSearchPanelPopupControl.prototype.handleBodySize = function () {\r\n    clearTimeout(this.handleBodySizeTimer);\r\n    let self = this;\r\n\r\n    this.handleBodySizeTimer = setTimeout(function () {\r\n        let win = $(window);\r\n\r\n        self.body.css({\r\n            top: self.button.offset().top + self.button.outerHeight(),\r\n            right: 0\r\n        })\r\n\r\n        if (self.body.position().top + self.body.height() > win.height()) {\r\n            self.body.css({\r\n                position: \"absolute\"\r\n            })\r\n        } else {\r\n            self.body.css({\r\n                position: \"fixed\"\r\n            })\r\n        };\r\n\r\n        if (win.width() > self.bodyWidth) {\r\n            self.body.css({\r\n                width: self.bodyWidth + \"px\"\r\n            });\r\n        } else {\r\n            self.body.css({\r\n                width: win.width() + \"px\"\r\n            });\r\n        };\r\n    }, 100);\r\n};\r\n\r\nSearchPanelPopupControl.prototype.getData = function () {\r\n    this._data = this.body.serializeArray();\r\n    return this._data;\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./javascripts/searchPanel.js\n **/","\"use strict\";\r\n\r\nexport default class SockConnection {\r\n    constructor (url) {\r\n        this.url = url;\r\n        this.callbacks = {\r\n            searchResult: null\r\n        }\r\n    };\r\n    \r\n    connect () {\r\n        require.ensure([], () => {\r\n            var SockJS = require(\"sockjs\");\r\n\r\n            this.connection = new SockJS(this.url);\r\n            //this.connection.addEventListener(\"connection\", this.setHandlers);\r\n\r\n            var self = this;\r\n            this.connection.onopen = function() {\r\n                //console.log(self.connection.readyState);\r\n                //self.connection.send(\"test\");\r\n            };\r\n\r\n            this.connection.onmessage = function (event) {\r\n                var json = JSON.parse(event.data),\r\n                    data = json.data,\r\n                    type = json.type,\r\n                    done = json.done,\r\n                    key = json.key;\r\n\r\n                if (!self.callbacks[type]) return;\r\n\r\n                if (data === \"Error\") self.callbacks[type](new Error(type + \" error\"));\r\n                else self.callbacks[type](null, data, done, key);\r\n            };\r\n        });\r\n    };\r\n\r\n    send (data) {\r\n        this.lastRequest = data;\r\n        this.connection.send(data);\r\n    };\r\n\r\n    setHandlers () {\r\n\r\n    }\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./javascripts/SockConnection.js\n **/","\"use strict\";\r\n\r\nfunction sideMenuListener () {\r\n\r\n    $(document).ready(function () {\r\n\r\n        $(\".side-menu\").on(\"contextmenu\", \".menu-button\", menuButtonClick);\r\n\r\n    });\r\n\r\n    function menuButtonClick (event) {\r\n        if (findTarget($(event.target), \"popup-menu\")) return;\r\n\r\n        $(\".popup-menu\").remove();\r\n\r\n        if (mode !== \"edit\") return;\r\n\r\n        var popupMenu = new PopupMenu($(this), event, {\r\n            \"Удалить категорию\": [deleteCategory.bind($(this))]\r\n        });\r\n\r\n        event.preventDefault();\r\n    }\r\n\r\n    function deleteCategory() {\r\n        var self = this;\r\n\r\n        makeDBDelRequest(\"/dbdel?db=Category&name=\" + this.find(\"a\").text(), function (err) {\r\n            if (err) {\r\n                alert (err.message);\r\n                return;\r\n            };\r\n            self.remove();\r\n        });\r\n    };\r\n\r\n};\r\n\r\nfunction sideMenuActive(target) {\r\n    $(\".side-menu > .menu-button\").removeClass(\"active\");\r\n    target.parent().addClass(\"active\");\r\n    target.blur();\r\n};\r\n\r\nexport {sideMenuListener, sideMenuActive};\n\n\n/** WEBPACK FOOTER **\n ** ./javascripts/sideMenu.js\n **/"],"sourceRoot":""}